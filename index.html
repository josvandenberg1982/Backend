<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">

<title>Taakplanner</title>

<style>
:root{
  --border:#ddd;
  --bg:#fff;
  --soft:#fafafa;
  --soft2:#f6f7f8;
  --radius:16px;
  --shadow:0 1px 0 rgba(0,0,0,.05);

  --blue:#2563eb;
  --blue-dark:#1d4ed8;
}

*{ box-sizing:border-box; }
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:var(--bg);
}

input,select,textarea,button{
  width:100%;
  font-size:16px;   /* iOS zoom fix */
  margin:6px 0;
}

nav{
  display:none;
  gap:10px;
  padding:10px;
  border-bottom:1px solid var(--border);
  position:sticky;
  top:0;
  background:#fff;
}

section{
  max-width:1100px;
  margin:0 auto;
  padding:12px;
}

h2{ margin-top:0; }

.card{
  background:#fff;
  border:1px solid var(--border);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  margin-bottom:12px;
}

.card-head{
  padding:10px 12px;
  border-bottom:1px solid var(--border);
  font-weight:600;
}

.card-body{ padding:12px; }

.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.row > *{ flex:1 1 180px; }

.btn{
  border:1px solid var(--border);
  background:#fff;
  border-radius:14px;
  padding:10px 12px;
  cursor:pointer;
}

.btn-primary{
  background:var(--blue);
  color:#fff;
  border-color:var(--blue);
  font-weight:700;
  min-height:56px;
}
.btn-primary:hover{
  background:var(--blue-dark);
  border-color:var(--blue-dark);
}

.pill{
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:3px 10px;
  border:1px solid #ccc;
  border-radius:999px;
  font-size:12px;
  margin:4px 6px 0 0;
  background:#fff;
}

.dot{
  width:10px;
  height:10px;
  border-radius:999px;
  border:1px solid rgba(0,0,0,.2);
}

.small{ font-size:12px; color:#666; }

/* label selector */
.label-box{
  border:1px solid #ddd;
  border-radius:12px;
  padding:8px;
  background:#fff;
}
.label-item{
  display:flex;
  align-items:center;
  gap:8px;
  margin:6px 0;
}
.label-item input{ width:auto; }
</style>
</head>

<body>

<nav>
  <button class="btn btn-primary" onclick="show('create')">Nieuwe taak</button>
  <button class="btn" onclick="show('tasks')">Takenlijst</button>
  <button class="btn" onclick="show('week')">Week</button>
  <button class="btn" onclick="show('settings')">Settings</button>
</nav>

<!-- CREATE -->
<section id="create" hidden>
  <div class="card">
    <div class="card-head">Nieuwe taak</div>
    <div class="card-body">
      <form onsubmit="addTask(event)">
        <label>Titel</label>
        <input id="title" required>

        <div class="row">
          <div>
            <label>Project</label>
            <select id="createProject"></select>
          </div>
          <div>
            <label>Prioriteit</label>
            <select id="createPriority">
              <option>High</option>
              <option selected>Medium</option>
              <option>Low</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div>
            <label>Datum inplannen</label>
            <input id="createPlanned" type="date">
          </div>
          <div>
            <label>Deadline</label>
            <input id="createDeadline" type="date">
          </div>
        </div>

        <label>Labels</label>
        <div id="createLabels" class="label-box"></div>

        <button class="btn btn-primary" type="submit">Taak toevoegen</button>
      </form>
    </div>
  </div>
</section>

<!-- TASKS -->
<section id="tasks" hidden>
  <h2>Takenlijst</h2>
  <div id="taskList"></div>
</section>

<!-- SETTINGS -->
<section id="settings" hidden>
  <h2>Settings</h2>

  <div class="card">
    <div class="card-head">Labels</div>
    <div class="card-body">
      <div class="row">
        <input id="newLabel" placeholder="Label naam">
        <input id="newLabelColor" type="color" value="#64748b">
        <button class="btn btn-primary" onclick="addLabel()">Label toevoegen</button>
      </div>
      <ul id="labelList"></ul>
    </div>
  </div>
</section>

<script>
/* ===== STATE ===== */
const KEY="taskplanner_v9";
let state=load();

function load(){
  const raw=localStorage.getItem(KEY);
  if(!raw){
    return{
      tasks:[],
      projects:["Algemeen"],
      labels:[],
    };
  }
  return JSON.parse(raw);
}
function save(){
  localStorage.setItem(KEY,JSON.stringify(state));
}

/* ===== NAV ===== */
function show(id){
  document.querySelectorAll("section").forEach(s=>s.hidden=true);
  document.getElementById(id).hidden=false;
  if(id==="create")renderCreate();
  if(id==="tasks")renderTasks();
  if(id==="settings")renderSettings();
}

/* ===== CREATE ===== */
function renderCreate(){
  createProject.innerHTML=state.projects.map(p=>`<option>${p}</option>`).join("");
  createLabels.innerHTML=state.labels.map(l=>`
    <label class="label-item">
      <input type="checkbox" value="${l.name}">
      <span class="dot" style="background:${l.color}"></span>
      ${l.name}
    </label>
  `).join("");
}

function addTask(e){
  e.preventDefault();
  const labels=[...createLabels.querySelectorAll("input:checked")].map(i=>i.value);
  state.tasks.push({
    id:crypto.randomUUID(),
    title:title.value,
    project:createProject.value,
    priority:createPriority.value,
    planned:createPlanned.value,
    deadline:createDeadline.value,
    labels
  });
  save();
  show("tasks");
}

/* ===== TASK LIST ===== */
function renderTasks(){
  taskList.innerHTML="";
  state.tasks.forEach(t=>{
    const div=document.createElement("div");
    div.className="card";
    div.innerHTML=`
      <div class="card-body">
        <strong>${t.title}</strong>
        <div>
          ${t.labels.map(l=>{
            const def=state.labels.find(x=>x.name===l);
            return `<span class="pill"><span class="dot" style="background:${def?.color||"#999"}"></span>${l}</span>`;
          }).join("")}
        </div>
      </div>
    `;
    taskList.appendChild(div);
  });
}

/* ===== LABELS ===== */
function renderSettings(){
  labelList.innerHTML="";
  state.labels.forEach(l=>{
    const li=document.createElement("li");
    li.innerHTML=`
      <span class="pill">
        <span class="dot" style="background:${l.color}"></span>${l.name}
      </span>
    `;
    labelList.appendChild(li);
  });
}
function addLabel(){
  if(!newLabel.value)return;
  state.labels.push({name:newLabel.value,color:newLabelColor.value});
  newLabel.value="";
  save();
  renderSettings();
}

/* INIT */
document.querySelector("nav").style.display="flex";
show("create");
</script>

</body>
</html>
